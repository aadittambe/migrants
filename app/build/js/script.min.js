var myLine,legend,mobileZoom=0,options=(console.log(parent.innerWidth),parent.innerWidth<600&&(mobileZoom=4),{coords:[51.505,-.09],zoom:2.5}),ctx=document.getElementById("canvas").getContext("2d"),map=(window.chartColors={red:"#990000",yellow:"#fbd603",grey:"#666666",yellowAccent:"#faa916",greenAccent:"#8fd694"},L.map("map").setView(options.coords,options.zoom)),markerLayer=new L.LayerGroup,osmLayer=new L.TileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiYWFkaXR0YW1iZSIsImEiOiJja3YxMXNzNjI3c2RhMnFxNnFqajZqdnZwIn0.a9gwkXW78sxu51NyWADROA",{id:"mapbox/light-v10",attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>'});function getColor(a){return"Violence"==a?"#edad08":"Harsh environmental conditions"==a?"#73af48":"Drowning"==a?"#cc503e":"Vehicle accident"==a?"#38a6a5":"Inadequate healthcare access"==a?"#e17c05":"Mixed or unknown"==a?"#5f4690":"Accidental death"==a?"#94346e":"#666"}function drawLegend(){(legend=L.control({position:"bottomright"})).onAdd=function(a){for(var e=L.DomUtil.create("div","info legend"),o=[],t=["Violence","Harsh environmental conditions","Drowning","Vehicle accident","Inadequate healthcare access","Mixed or unknown","Accidental death"],i=0;i<t.length;i++)e.innerHTML+=o.push('<i style="background:'+getColor(t[i])+'"></i> '+(t[i]||"+"));return e.innerHTML=o.join("<br>"),e},legend.addTo(map)}function allData(){d3.csv("https://raw.githubusercontent.com/aadittambe/migrants/main/data/data.csv").then(function(a){legend&&map.removeControl(legend),a.forEach(a=>{a.number_of_dead;a=L.circleMarker([a.lat,a.lon],{stroke:!0,color:"#990000",weight:1,opacity:.5,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillopacity:.4,interactive:!1}).bindPopup("I am a "+a);markerLayer.addLayer(a),markerLayer.addTo(map),map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove()})})}function addDataByType(){d3.csv("https://raw.githubusercontent.com/aadittambe/migrants/main/data/data.csv").then(function(a){a.forEach(a=>{"Violence"==a.death_cause_clean?e="#edad08":"Harsh environmental conditions"==a.death_cause_clean?e="#73af48":"Drowning"==a.death_cause_clean?e="#cc503e":"Vehicle accident"==a.death_cause_clean?e="38a6a5":"Sickness inadequate healthcare access"==a.death_cause_clean?e="e17c05":"Mixed or unknown"==a.death_cause_clean?e="#5f4690":"Accidental death"==a.death_cause_clean&&(e="#94346e");var e=L.circleMarker([a.lat,a.lon],{stroke:!0,color:e,weight:1,opacity:.5,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillopacity:.2,interactive:!1});markerLayer.addLayer(e),markerLayer.addTo(map),map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove()}),drawLegend()})}function usMexico(o){d3.csv("https://raw.githubusercontent.com/aadittambe/migrants/main/data/mexico_to_us.csv").then(function(a){legend&&map.removeControl(legend),a.forEach(a=>{var e;"all"==o&&(e=L.circleMarker([a.lat,a.lon],{stroke:!0,color:"#990000",weight:1,opacity:.5,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillOpacity:.4,interactive:!1}),markerLayer.addLayer(e),markerLayer.addTo(map),map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove()),a.incident_year==o&&(e=L.circleMarker([a.lat,a.lon],{stroke:!0,color:"#990000",weight:1,opacity:.5,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillOpacity:.4,interactive:!1}),markerLayer.addLayer(e),markerLayer.addTo(map),map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove())})})}function europe(o){d3.csv("https://raw.githubusercontent.com/aadittambe/migrants/main/data/europe.csv").then(function(a){a.forEach(a=>{var e;legend&&map.removeControl(legend),"biggest"==o&&"2015.MMP00108"==a.main_id&&(e=L.circleMarker([a.lat,a.lon],{stroke:!0,color:"#990000",weight:1,opacity:.5,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillopacity:.4,interactive:!1}).bindPopup("I am a "+a),markerLayer.addLayer(e),markerLayer.addTo(map),e.options.interactive=!1,map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove()),"more_than_100"==o&&(legend&&map.removeControl(legend),100<a.total_number_of_dead_and_missing&&(e=L.circleMarker([a.lat,a.lon],{stroke:!0,color:"#990000",weight:1,opacity:.5,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillopacity:.4,interactive:!1}).bindPopup("I am a "+a),markerLayer.addLayer(e),markerLayer.addTo(map),e.options.interactive=!1,map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove())),"all"==o&&(legend&&map.removeControl(legend),e=L.circleMarker([a.lat,a.lon],{stroke:!0,color:"#990000",weight:1,opacity:.5,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillopacity:.4,interactive:!1}).bindPopup("I am a "+a),markerLayer.addLayer(e),markerLayer.addTo(map),e.options.interactive=!1,map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove())})})}function europeAllFiltered(){d3.csv("https://raw.githubusercontent.com/aadittambe/migrants/main/data/europe.csv").then(function(a){a.forEach(a=>{"Violence"==a.death_cause_clean?e="#edad08":"Harsh environmental conditions"==a.death_cause_clean?e="#73af48":"Drowning"==a.death_cause_clean?e="#cc503e":"Vehicle accident"==a.death_cause_clean?e="#38a6a5":"Sickness inadequate healthcare access"==a.death_cause_clean?e="#e17c05":"Mixed or unknown"==a.death_cause_clean?e="#5f4690":"Accidental death"==a.death_cause_clean&&(e="#94346e");var e=L.circleMarker([a.lat,a.lon],{stroke:!0,color:e,weight:1,opacity:.7,radius:Math.sqrt(a.total_number_of_dead_and_missing),fill:!0,fillopacity:.5,interactive:!1});markerLayer.addLayer(e),markerLayer.addTo(map),map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.boxZoom.disable(),map.keyboard.disable(),map.zoomControl.remove()}),drawLegend()})}map.addLayer(osmLayer);var scroller=scrollama();function handleResize(){scroller.resize()}function handleStepEnter(c,a){console.log(c.index),0==c.index&&(mobileZoom=0,parent.innerWidth<600&&(mobileZoom=2),options={coords:[0,0],zoom:2.5-mobileZoom},markerLayer.clearLayers(),map.flyTo(options.coords,options.zoom,{animation:!0}),allData()),1==c.index&&(mobileZoom=0,parent.innerWidth<600&&(mobileZoom=2),options={coords:[0,0],zoom:2.5-mobileZoom},markerLayer.clearLayers(),map.flyTo(options.coords,options.zoom,{animation:!0}),addDataByType()),2==c.index&&(options={coords:[29.7434877,-105.9591008],zoom:5-mobileZoom,radius:5},markerLayer.clearLayers(),map.flyTo(options.coords,options.zoom,{animation:!0}),usMexico("all")),3==c.index&&(options={coords:[32.5380366,15.3389586],zoom:4-mobileZoom},markerLayer.clearLayers(),map.flyTo(options.coords,options.zoom,{animation:!0}),europe("all")),4==c.index&&(options={coords:[32.5380366,15.3389586],zoom:4-mobileZoom},markerLayer.clearLayers(),map.flyTo(options.coords,options.zoom,{animation:!0}),europeAllFiltered()),5==c.index&&(options={coords:[32.5380366,15.3389586],zoom:6-mobileZoom},markerLayer.clearLayers(),map.flyTo(options.coords,options.zoom,{animation:!0}),europe("biggest")),6==c.index&&(options={coords:[32.5380366,15.3389586],zoom:5-mobileZoom},markerLayer.clearLayers(),map.flyTo(options.coords,options.zoom,{animation:!0}),europe("more_than_100")),d3.csv("https://raw.githubusercontent.com/aadittambe/migrants/main/data/month_and_cause.csv").then(function(e){console.log(e);let o=[],t=[],i=[],n=[],d=[],r=[],l=[],s=[];for(let a=0;a<e.length;a++){var m=e[a].month_year,m=(o.push(m),e[a]["Accidental death"]),m=(t.push(m),e[a].Drowning),m=(i.push(m),e[a]["Harsh environmental conditions"]),m=(n.push(m),e[a]["Mixed or unknown"]),m=(d.push(m),e[a]["Inadequate healthcare access"]),m=(r.push(m),e[a]["Vehicle accident"]),m=(l.push(m),e[a].Violence);s.push(m)}var a={type:"bar",data:{labels:o,datasets:[{label:"Accidental death",backgroundColor:"#94346e",borderColor:"#94346e",data:t,fill:!1,pointRadius:0,pointHoverRadius:5,borderWidth:3}]},options:{events:[],responsive:!0,aspectRatio:1.5,title:{display:!0,text:"Chart.js Line Chart"},tooltips:{enabled:!1,mode:"label"},hover:{mode:"nearest",intersect:!0},elements:{line:{tension:.5}},scales:{x:{stacked:!0,grid:{display:!1}},y:{gridLines:{zeroLineWidth:20},weight:10,max:1800,min:0,stacked:!0,grid:{display:!1}}}}};7==c.index&&(myLine?myLine.data.datasets[1]?(myLine.data.datasets[1].data="",myLine.update()):myLine.data.datasets[2]&&(myLine.data.datasets[2].data="",myLine.update()):(myLine=new Chart(ctx,a),$(window).bind("beforeunload",function(){myLine.update()}))),8==c.index&&(a={label:"Sickness",backgroundColor:"#e17c05",borderColor:"#e17c05",data:r,pointRadius:1},myLine&&(myLine.data.datasets[1]=a,myLine.update()),myLine.data.datasets[2]&&(myLine.data.datasets[2].data="",myLine.update())),9==c.index&&(a={label:"Violence",backgroundColor:"#edad08",borderColor:"#edad08",data:s,pointRadius:1},myLine&&(myLine.data.datasets[2]=a,myLine.update()),myLine.data.datasets[3]&&(myLine.data.datasets[3].data="",myLine.update())),10==c.index&&(a={label:"Harsh environmental condition",backgroundColor:"#73af48",borderColor:"#73af48",data:n,pointRadius:1},myLine&&(myLine.data.datasets[3]=a,myLine.update()),myLine.data.datasets[4]&&(myLine.data.datasets[4].data="",myLine.update())),11==c.index&&(a={label:"Vehicle accident",backgroundColor:"#38a6a5",borderColor:"#38a6a5",data:l,pointRadius:1},myLine&&(myLine.data.datasets[4]=a,myLine.update()),myLine.data.datasets[5]&&(myLine.data.datasets[5].data="",myLine.update())),12==c.index&&(a={label:"Mixed or unknown",backgroundColor:"#5f4690",borderColor:"#5f4690",data:d,pointRadius:1},myLine&&(myLine.data.datasets[5]=a,myLine.update()),myLine.data.datasets[6]&&(myLine.data.datasets[6].data="",myLine.update())),13==c.index&&(a={label:"Drowing",backgroundColor:"#cc503e",borderColor:"#cc503e",data:i,pointRadius:1},myLine&&(myLine.data.datasets[6]=a,myLine.update()),myLine.data.datasets[7]&&(myLine.data.datasets[7].data="",myLine.update()))}),c.index,d3.selectAll(a+" .scroll-graphic-tab").attr("class",function(a,e){return 1==d3.select(this).attr("data-step")&&c.index<=6||2==d3.select(this).attr("data-step")&&c.index<=18||d3.select(this).attr("data-step")==c.index+1?"scroll-graphic-tab d-block":"scroll-graphic-tab d-none"})}function handleContainerEnter(a){}function handleContainerExit(a){}function init(){handleResize(),scroller.setup({container:"#scroll",graphic:"#scroll .scroll-graphic",step:"#scroll .scroll-text .step",debug:!1,offset:.5}).onStepEnter(function(a){return handleStepEnter(a,"#scroll")}),window.addEventListener("resize",handleResize)}init();for(var i=0;i<5895;i++)$("#divRepeat").append($(".box").html());new TypeIt("#element",{speed:200}).type("By").pause(1e3).type(" Adit").pause(900).move(-3).pause(400).type("a").move(4).pause(1e3).type(" Tsmbe").delete(4).pause(900).type("ambe").go();